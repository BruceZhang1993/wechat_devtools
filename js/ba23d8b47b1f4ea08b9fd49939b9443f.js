'use strict';!function(require,directRequire){function a(){i.removeAudio()}const b=require('url'),c=require('./0634ee2ebd3e560d9d4804ecc960160f.js'),d=require('./15ba1827c7f6564a45df6bd44da3a977.js'),e=require('./3bfffbe88b3d923921f851c0697974fe.js'),f=require('./1dea83a77e99a7c94f6b6f01f5c175b0.js'),g=require('./f171257bbcaef547a3cf27266ccb0db2.js'),h=require('./72653d4b93cdd7443296229431a7aa9a.js'),i=require('./35a5c665bbd039baf968211c3ff216fc.js'),j=require('./83822ab95828f61bf6a61c04d53246a8.js'),k=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),l=require('./da7c31daaf542cf1796023d8e344b98a.js'),m=require('./c6f15ef7a40988103528a2ff766b2425.js'),n=require('./2dfc6a3df6d6fc51266b293c8420e88b.js'),o=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),p=require('./common/locales/index.js'),q=require('./cc2c2970ff81ae4a83123e81ee123da2.js'),r=(a)=>{const b=e.getCurrent(),d=b.appid;return a==o.COMPILE_ORIGIN.SAVE_FILE?l('weapp_filechange_compile',d):a==o.COMPILE_ORIGIN.BUTTON?l('weapp_toolbar_compile',d):a==o.COMPILE_ORIGIN.SHORT_CUT&&l('weapp_key_compile',d),{type:c.SIMULATOR_COMPILE,data:a}};module.exports={launch:function(){return a(),async(a,b)=>{const d=e.getCurrent()||{},g=b(),h=await f(d);g.simulator.appConfig.extAppid!=h.extAppid&&(a(q.setProjectExtInfo({appid:h.extAppid})),a(q.requestProjectAttr()));const i=e.getCompileCondiction();let j=h&&h.pages&&h.pages[0]||'',l=j,m={},r=k.SCENE_DEFAULT,s=!1;if(i){let a=i.query&&i.query.split('&')||[];a.forEach((a)=>{if(a){let b=a.split('=');m[b[0]]=b[1]}}),i.pathName&&(l=i.pathName,-1===h.pages.indexOf(l)&&n.display({command:o.DISPLAY_ERROR,type:k.errorPrefix.JSON_ERROR,force:!0,data:{title:p.config.JSON_CUSTOM_COMPILE_PATH_NOT_EXISTS_TITLE,msg:p.config.JSON_CUSTOM_COMPILE_PATH_NOT_EXISTS.format(l)}})),i.scene&&(r=i.scene),j!=l&&(s=!0)}a({type:c.SIMULATOR_LAUNCH,data:{home:s,pathName:l,query:m,scene:r},appConfig:h})}},setAppLaunched:(a)=>(b)=>{if(a)return void b({type:c.SIMULATOR_SET_APP_LAUNCHED,flag:a})},setWebviewReady:function(a,b){return{type:c.SIMULATOR_SET_WEBVIEW_READY,webviewID:a,ready:b}},hidePreviewImage:function(){return{type:c.SIMULATOR_SET_PREVIEW_IMAGE,data:{show:!1}}},hideActionSheet:function({callbackID:a,res:b}){return(d)=>{d({type:c.SIMULATOR_SET_ACTIONSHEET,data:{show:!1,callbackID:null,showOnWebviewID:-1}}),a&&d({type:c.ASSDK_CALLBACK,callbackID:a,res:b})}},hideModal:function({callbackID:a,res:b}){return(d)=>{d({type:c.SIMULATOR_SET_MODAL,data:{show:!1,callbackID:null,showOnWebviewID:-1}}),a&&d({type:c.ASSDK_CALLBACK,callbackID:a,res:b})}},hidePicker:function({callbackID:a,webviewID:b,res:d}){return(e)=>{e({type:c.SIMULATOR_SET_PICKER,data:{show:!1}}),a&&e({type:c.JSSDK_CALLBACK,callbackID:a,webviewID:b,res:d})}},hideShare:function({callbackID:a,res:b}){return(d)=>{d({type:c.SIMULATOR_SET_SHARE,data:{show:!1}}),a&&d({type:c.ASSDK_CALLBACK,callbackID:a,res:b})}},hideGroupList:function(a){return(b)=>{b({type:c.SIMULATOR_SET_GROUP_INFO,data:{show:!1}}),a&&b({type:c.SIMULATOR_SET_SHARE,data:{show:!0,group:a}})}},setAppConfig:function(a){return{type:c.SIMULATOR_SET_APP_CONFIG,data:a}},setDebuggee:function(a,b,d){return{type:c.SIMULATOR_SET_DEBUGGEE,debuggee:a,webviewID:b,flag:d}},hideConfirm:function(){return{type:c.SIMULATOR_SET_CONFIRM,data:{show:!1,content:'',callback:()=>{}}}},hideSetting:function({scopeList:a,callbackID:b,api:f}){return async(i)=>{let j='';if(a&&0<a.length)try{let{body:b}=await d({url:`${g.setAuth}`,method:'post',body:JSON.stringify({appid:e.getProjectAppID(),auth_item:a}),needToken:1,needAppID:1})}catch(a){h.error(`hideSetting setAuth error ${a}`),j=a}let k={};if(j)k.errMsg=`${f}:fail ${j}`;else{let b=a.map((a)=>{return{state:a.state,scope:a.scope,desc:a.scope_desc}});k.errMsg=`${f}:ok`,k.authSetting=b}i({type:c.ASSDK_CALLBACK,callbackID:b,res:k}),i({type:c.SIMULATOR_SET_SETTING,data:{show:!1}})}},setAppRoute:function(a){return{type:c.SIMULATOR_SET_APP_ROUTE,data:a}},switchTab:function(a,b){return{type:c.SIMULATOR_OPEN_TABBAR,data:{pathName:a,tabbarIndex:b}}},setAuthorize:function(a){return{type:c.SIMULATOR_SET_AUTHORIZE_CONFIRM,data:{show:a}}},setShareDataURI:function(a,b){return{type:c.SIMULATOR_SET_SHARE_DATAURI,data:{webviewID:a,dataURI:b}}},setRightBtnActionSheet:function(a){return{type:c.SIMULATOR_SET_RIGHTBTN_ACTIONSHEET,data:a}},setPayment:function(a){return{type:c.SIMULATOR_SET_PAYMENT_QRWND,data:a}},hideMap:function({callbackID:a,res:b}){return(d)=>{d({type:c.SIMULATOR_SET_LOCATION,data:{show:!1,callbackID:null,src:''}}),a&&d({type:c.ASSDK_CALLBACK,callbackID:a,res:b})}},hideCardView:function({callbackID:a,res:b}){return(d)=>{d({type:c.SIMULATOR_SET_CARD_VIEW,data:{show:'none',cardInfo:[]}}),a&&d({type:c.ASSDK_CALLBACK,callbackID:a,res:b})}},batchAddCard:function({callbackID:a,list:b}){return(f)=>{let h={appid:e.getProjectAppID(),acceptitem_list:b},i={url:`${g.batchAddCardURL}?isapp=1`,body:JSON.stringify(h),method:'post',needToken:1,needAppID:1};d(i).then((d)=>{let e=d.body,g=e.resp_list;g=g.map((a,c)=>{let d=b[c],e=JSON.parse(a.json_ret);return{cardId:d.card_id,cartExt:d.card_ext,code:e.encrypt_code,isSuccess:!0}}),f({type:c.ASSDK_CALLBACK,callbackID:a,res:{errMsg:`addCard:ok`,cardList:g}})}).catch((b)=>{f({type:c.ASSDK_CALLBACK,callbackID:a,res:{errMsg:`addCard:fail ${b}`}})}),f({type:c.SIMULATOR_SET_CARD_VIEW,data:{show:'none',cardInfo:[]}})}},setBackground:function(a){return{type:c.SIMULATOR_SET_BACKGROUND,data:a}},toggleBackground:function(){return{type:c.SIMULATOR_TOGGLE_BACKGROUND}},setWidget:function(a){return{type:c.SIMULATOR_SET_WIDGET,data:a}},reLaunchToIndexPage:function(){return{type:c.SIMULATOR_RELAUNCH_TO_INDEX}},captureScreen:function(){return(a,b)=>new Promise((a,c)=>{const d=global.windowMap.get('MAIN'),e=b().simulator.currentWebviewID,f=d.window.document.querySelector(`.webviewbody${e}`);f?f.captureVisibleRegion({format:'png'},(b)=>{let c=Buffer.from(b.replace('data:image/png;base64,',''),'base64'),d=m.copyFileDataToTemp(c,'.png');a({errMsg:'captureScreen:ok',tempFilePath:d})}):c({errMsg:'captureScreen:fail'})})},setWxmlInspect:function(a){return{type:c.SIMULATOR_SET_WXMLINSPECT,data:a}},setVibrate:function(a){return{type:c.SIMULATOR_SET_VIBRATE,data:{type:a}}},insertHTMLWebView:function({callbackID:a,webviewID:b,res:d}){return(e)=>{a&&e({type:c.JSSDK_CALLBACK,callbackID:a,webviewID:b,res:d})}},updateHTMLWebView:function({callbackID:a,webviewID:b,res:d}){return(e)=>{a&&e({type:c.JSSDK_CALLBACK,callbackID:a,webviewID:b,res:d})}},compile:(a)=>{return(b,c)=>{const d=c();d.settings.edit.saveBeforeCompile?(j.ready=!0,j.send({type:'COMMAND',command:'saveAllAndCompile',data:a})):b(r(a))}},compileImmediate:r,setConfirm:function(a){return{type:c.SIMULATOR_SET_CONFIRM,data:a}}}}(require('lazyload'),require);