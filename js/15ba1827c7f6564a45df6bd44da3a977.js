'use strict';!function(require,directRequire){const a=require('./233d77ecf0781f44985f684f70e316d0.js'),b=require('./89ba85d67a88f7636d657c22b5d3e038.js'),c=require('./df6d0ff021a69fb541c733de4dbba0fe.js'),d=require('./9c906d27ca74e18d0deaaa231e71fdfa.js'),e=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),f=require('./3bfffbe88b3d923921f851c0697974fe.js'),g=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),h=require('./f171257bbcaef547a3cf27266ccb0db2.js'),i=require('./common/locales/index.js'),j=require('./72653d4b93cdd7443296229431a7aa9a.js'),{NOT_LOGIN:k,INVALID_TOKEN:l,INVALID_LOGIN:m,DEV_NEED_RELOGIN:n,DEV_INVALID_SIGNATURE:o,DEV_EXPIRED_SIGNATURE:p}=c,q='darwin'===process.platform?'darwin':'win',r=global.appVersion.replace(/\./g,''),s=(a)=>{let{needAppID:b,needRandom:c,needSystemInfo:d}=a;delete a.needAppID,delete a.needRandom;let e=(a.url||'').split('?'),g=e[0],h=[];return-1!==c&&h.push(`_r=${Math.random()}`),1===b&&h.push(`${f.formatAppIDQuery()}`),-1!==d&&h.push(`os=${q}&clientversion=${r}`),e[1]&&h.push(e[1]),a.url=`${g}?${h.join('&')}`,a},t=(a)=>{return a===k||a===m||a===l||a===n||a===p||a===o?(e.dispatch(d.loginExpired()),!0):void 0},u=(b)=>{return new Promise((c,d)=>{a(b,(a,b,e)=>{a&&d(a),c({resp:b,body:e})})})};module.exports=async function(a){let{needToken:c,needParse:d,needCheckErrCode:e,needCheckStatusCode:f,forceLogin:h}=a;if(delete a.needToken,delete a.needParse,delete a.needCheckErrCode,delete a.needCheckStatusCode,1===c)try{a=await b.makeRequestOptionsWithLoginState(a)}catch(a){if(1===c&&-1!=h)throw t(a),i.config.CGI_ERR_NEED_RELOGIN;else;}a=s(a);let{resp:k,body:l}=await u(a,!0);if(-1!==f){const b=k.statusCode;if(200!=b&&206!=b)throw j.error(`${a.url} ${b}`),i.config.NETWORK_ERROR.format(b)}if(-1===d)return{resp:k,body:l};try{let b=JSON.parse(l);if(-1!==e){let d=b.baseresponse||{},e=d.errcode;if(void 0!==e&&0!==e){1===c&&-1!=h&&t(e);let b=g.parseCgiErrorCode(e,d.errmsg);throw j.error(`${a.url} ${b}`),b}}return{resp:k,body:b}}catch(b){throw j.error(`${a.url} ${b}`),b}}}(require('lazyload'),require);