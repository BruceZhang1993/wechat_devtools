'use strict';!function(require,directRequire){const a=require('fs'),b=require('react'),c=require('./3b5f8e2469c474c8d433c1c6926d8999.js'),d=require('./fc137838572a83604db39acff8e909e0.js'),e=require('./cc2c2970ff81ae4a83123e81ee123da2.js'),f=require('./6ff091369f442a4678a2ed4a1f758495.js'),g=require('./eadce02c750c875a10680bcfedadec88.js'),h=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),i=require('./3c55dff3626a3ee184d599f076158345.js'),j=require('./d28a711224425b00101635efe1034c99.js'),k=require('./da7c31daaf542cf1796023d8e344b98a.js'),l=require('redux'),{connect:m}=require('react-redux');class n extends b.Component{constructor(a){super(a);let b=j.getVendorConfig();this.state={lazyLoaded:!!a.show,libs:Object.keys(b.libs).reverse(),libDropDownLeft:0,libDropDownTop:0};let c=j.setVersion(a.project.libVersion);c!=a.project.libVersion&&a.setProjectLibVersion(c),this._onVendorChange=this.onVendorChange.bind(this)}componentDidMount(){j.on('VENDOR_CONFIG_CHANGE',this._onVendorChange)}componentWillUnmount(){j.off('VENDOR_CONFIG_CHANGE',this._onVendorChange)}componentWillReceiveProps(a){a.showDropDown||this.setState({showLibs:!1}),a.show?this.setState({lazyLoaded:!0}):this.setState({showLibs:!1})}onVendorChange(a){this.setState({libs:Object.keys(a.libs).reverse()})}formatTime(a){return a?new Date(a).toTimeString():'----'}onShowLibs(a){if(a.stopPropagation(),this.state.showLibs)this.setState({showLibs:!1});else{let b=a.currentTarget,c=b.getBoundingClientRect();this.setState({showLibs:!this.state.showLibs,libDropDownLeft:c.left,libDropDownTop:c.top+25}),this.props.onDropdownShow&&this.props.onDropdownShow(a)}}onSettingChange(a){let b=this.props.project.setting[a];this.props.setProjectSetting({[a]:!b});let c=this.props.project.appid;switch(a){case'es6':{k(b?'weapp_toolbar_details_closees6':'weapp_toolbar_details_openes6',c);break}case'minified':{k(b?'weapp_toolbar_details_closemin':'weapp_toolbar_details_openmin',c);break}case'postcss':{k(b?'weapp_toolbar_details_closecss':'weapp_toolbar_details_opencss',c);break}case'urlCheck':{k(b?'weapp_toolbar_details_closeurl':'weapp_toolbar_details_openurl',c);break}}}onSelectClick(a){this.props.setProjectLibVersion(this.state.libs[a]),this.setState({showLibs:!1})}onTestClick(){this.props.openMobileTest()}jumpToWXSDocument(a){a.stopPropagation(),nw.Shell.openExternal('https://developers.weixin.qq.com/blogdetail?action=get_post_info&lang=zh_CN&docid=47e9b796f3c941368b1ad9f5d73b14d1')}render(){if(!this.state.lazyLoaded)return null;let a=this.props,c=a.project,d=c.history||{},e=this.formatTime(d.test),f=this.formatTime(d.upload),g=this.formatTime(d.preview),h=c.setting||{},j=`tab-content ${a.show?'tab-content-active':''}`;return b.createElement('div',{className:j},b.createElement('section',null,b.createElement('div',{className:'meta-item ui-flex'},b.createElement('label',{className:'meta-label'},'\u57FA\u7840\u5E93\u7248\u672C'),b.createElement('div',{className:'meta-value ui-flex-item'},b.createElement('div',{className:'ui-selector ui-selector-default',onClick:this.onShowLibs.bind(this)},b.createElement('input',{className:'ui-selector-input',placeholder:'',readOnly:!0,value:c.libVersion}),b.createElement('div',{className:'ui-selector-dropdown'},b.createElement('i',{className:this.state.showLibs?'ui-icon-arrow-up-o':'ui-icon-arrow-down-o'})),b.createElement(i,{show:this.state.showLibs,list:this.state.libs,left:this.state.libDropDownLeft,top:this.state.libDropDownTop,width:164,height:250,onSelectClick:this.onSelectClick.bind(this)}))))),b.createElement('section',null,b.createElement('div',{className:'meta-item ui-flex'},b.createElement('div',{className:'meta-value ui-flex-item'},b.createElement('label',{className:'ui-checkbox',onClick:this.onSettingChange.bind(this,'es6')},b.createElement('i',{className:h.es6?'ui-icon-checkbox-o':'ui-icon-checkbox'}),b.createElement('span',{className:'ui-checkbox-text'},'ES6 \u8F6C ES5')))),b.createElement('div',{className:'meta-item ui-flex'},b.createElement('div',{className:'meta-value ui-flex-item'},b.createElement('label',{className:'ui-checkbox',onClick:this.onSettingChange.bind(this,'postcss')},b.createElement('i',{className:h.postcss?'ui-icon-checkbox-o':'ui-icon-checkbox'}),b.createElement('span',{className:'ui-checkbox-text'},'\u4E0A\u4F20\u4EE3\u7801\u65F6\u6837\u5F0F\u81EA\u52A8\u8865\u5168')))),b.createElement('div',{className:'meta-item ui-flex'},b.createElement('div',{className:'meta-value ui-flex-item'},b.createElement('label',{className:'ui-checkbox',onClick:this.onSettingChange.bind(this,'minified')},b.createElement('i',{className:h.minified?'ui-icon-checkbox-o':'ui-icon-checkbox'}),b.createElement('span',{className:'ui-checkbox-text'},'\u4EE3\u7801\u4E0A\u4F20\u65F6\u81EA\u52A8\u538B\u7F29')))),b.createElement('div',{className:'meta-item ui-flex'},b.createElement('div',{className:'meta-value ui-flex-item'},b.createElement('label',{className:'ui-checkbox',onClick:this.onSettingChange.bind(this,'urlCheck')},b.createElement('i',{className:h.urlCheck?'ui-icon-checkbox':'ui-icon-checkbox-o'}),b.createElement('span',{className:'ui-checkbox-text'},'\u4E0D\u6821\u9A8C\u5B89\u5168\u57DF\u540D\u3001TLS \u7248\u672C\u4EE5\u53CA HTTPS \u8BC1\u4E66'))))))}}module.exports=m((a)=>{let b=a.info.projectInfo||{};return{show:'setting'===b.selected,project:a.project.current||{}}},(a)=>{return{toggleClickKey:h.bindActionCreators(d.toggleClickKey,a),setProjectSetting:h.bindActionCreators(e.setProjectSetting,a),setProjectLibVersion:h.bindActionCreators(e.setProjectLibVersion,a),openMobileTest:h.bindActionCreators(f.openMobileTest,a)}})(n)}(require('lazyload'),require);