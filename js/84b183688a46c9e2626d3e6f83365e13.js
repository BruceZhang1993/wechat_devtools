'use strict';!function(require,directRequire){function a(b){let c=m,d=f.createServer(()=>{});d.on('error',()=>{m++,a(b)}),d.listen(c,'127.0.0.1',()=>{d.once('close',()=>{m=c+1,b(c)}),d.close()})}function b(){let a=c(),b=g.lastVersion;a>b&&(nw.Shell.openExternal(j.NEW_VERSION_LOG),g.lastVersion=a)}function c(a){return a=a||global.appVersion,a=a.replace(/\./g,''),parseInt(a)}const d=require('fs'),e=require('path'),f=require('http'),g=require('./84858de8a097c9cf84ff2c2e3d86e2a9.js'),h=require('./72653d4b93cdd7443296229431a7aa9a.js'),i=require('./92320c1386e6db6a6f2556736a9bc280.js'),j=require('./f171257bbcaef547a3cf27266ccb0db2.js'),k='darwin'===process.platform,l=require('child_process');var m=9973;module.exports={getAvailablePort:async function(){return new Promise((b)=>{a((a)=>{b(a)})})},getType:function(a){return Object.prototype.toString.call(a).toLowerCase().split(' ')[1].replace(']','')},getAppConfig:function(){return{isDev:!!process.execPath.match('nw.exe')||!!process.execPath.match('nwjs.app')||!!process.execPath.match('nwjs.exe'),isBeta:!0===nw.App.manifest.beta,isGamma:!0===nw.App.manifest.gamma}},checkUpdateApp:async function(){let a=global.appVersion;if(b(),global.appConfig.isDev)return;let f=g.newVersion,j=c(f),m=c(a);if(m<j){h.info(`tools.js currentVersion: ${a} newVersion: ${f} `);let c=i.WeappApplication,j=k?e.join(c,f,'app.nw'):e.join(c,f,'package.nw');if(!d.existsSync(j))return;let m=global.contentDocument.querySelector('#container');return m.innerHTML='<div class="app-up-data">\u66F4\u65B0\u4E2D...</div>',new Promise((a,c)=>{let d=(d)=>{d?(m.innerHTML='<div class="app-up-data">\u66F4\u65B0\u5931\u8D25\uFF0C\u8BF7\u91CD\u65B0\u542F\u52A8</div>',c(d)):(m.innerHTML='',global.appVersion=f,m.innerHTML=`<div class="app-up-data">更新成功，当前版本 ${f}</div>`,global.contentWindow.title=`微信web开发者工具 v${f}`,global.Win.title=`微信web开发者工具 v${f}`,setTimeout(()=>{b(),a()},1e3)),g.removeNewVersion()};if(!k){const a=require('node-windows');let b=`xcopy "${j}" "${e.join(process.execPath,'..','package.nw')}" /s /e /y /i`;console.debug(b),a.elevate(b,d)}else{let a=global.appConfig.isDev?e.join(__dirname,'../../../'):e.join(__dirname,'../..');l.exec(`cp -r "${j}" "${a}"`,d)}})}},openInspectWin:function(){nw.Window.open('about:blank',{show:!1,width:799,height:799},(a)=>{a.maximize(),a.window.location='chrome://inspect/#devices',a.show()})},getVersionNum:c}}(require('lazyload'),require);