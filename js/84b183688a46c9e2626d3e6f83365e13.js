'use strict';!function(require,directRequire){function a(b){let c=p,d=i.createServer(()=>{});d.on('error',()=>{p++,a(b)}),d.listen(c,'127.0.0.1',()=>{d.once('close',()=>{p=c+1,b(c)}),d.close()})}function b(){let a=c(),b=j.lastVersion;a>b&&nw.Shell.openExternal(m.NEW_VERSION_LOG)}function c(a){return a=a||global.appVersion,a+='',a=a.replace(/\./g,''),parseInt(a)}function d(){let a=nw.App.getDataPath(),b=h.join(a,'Secure Preferences'),c=g.readFileSync(b,'utf8'),d=JSON.parse(c),{extensions:e}=d,{settings:f}=e,i=chrome.runtime.id,j=f[i];j.events=[],j.filtered_events={},g.writeFileSync(b+'_temp',JSON.stringify(d));let k=require('./d28a711224425b00101635efe1034c99.js'),m=h.join(l.WeappLog,`fixpreferences.log`);g.writeFileSync(b,JSON.stringify(d));let n=o.spawn(k.getFixpreferencesPath(),[b,`${b}_temp`,m,300],{stdio:'ignore',detached:!0});n.unref()}function e(){n&&d(),nw.App.quit()}function f(a){try{if(!g.existsSync(a))return;let b=g.statSync(a);if(b.isDirectory()){let b=g.readdirSync(a);if(0<b.length)for(let c=0,d=b.length;c<d;c++)f(h.join(a,b[c]));g.rmdirSync(a)}else g.unlinkSync(a)}catch(a){}}const g=require('fs'),h=require('path'),i=require('http'),j=require('./84858de8a097c9cf84ff2c2e3d86e2a9.js'),k=require('./72653d4b93cdd7443296229431a7aa9a.js'),l=require('./92320c1386e6db6a6f2556736a9bc280.js'),m=require('./f171257bbcaef547a3cf27266ccb0db2.js'),n='darwin'===process.platform,o=require('child_process');var p=9973;module.exports={getAvailablePort:async function(){return new Promise((b)=>{a((a)=>{b(a)})})},getType:function(a){return Object.prototype.toString.call(a).toLowerCase().split(' ')[1].replace(']','')},getAppConfig:function(){return{isDev:!!process.execPath.match('nw.exe')||!!process.execPath.match('nwjs.app')||!!process.execPath.match('nwjs.exe'),isBeta:!0===nw.App.manifest.beta,isGamma:!0===nw.App.manifest.gamma}},checkUpdateApp:async function(){return new Promise((a,d)=>{let f=global.appVersion,i=l.WeappApplication;if(b(),j.forceUpdateVersion){let b=j.forceUpdateVersion;j.removeForceUpdateVersion();let k=c(b),l=c(f),m='';if(l<k)m=`当前${f}版本太旧，请正在新版本${b}...`;else if(l>k)m=`当前版本${f}存在问题, 回退至版本${b}...`;else return a();const p=n?'darwin':'x64'===process.arch?'x64':'ia32';let q=`${p}_${b.replace(/\./g,'')}.${n?'dmg':'exe'}`,r=h.join(i,q);if(g.existsSync(r)){let a=global.contentDocument.querySelector('#container');a.innerHTML=`<div class="app-up-data" style="text-align:center;margin-top: 50%; font-size: 16px;padding:20px;">${m}</div>`;let b=n?'open':q,c=n?[q]:[];try{let d=o.spawn(b,c,{detached:!0,cwd:i});d.on('close',(b)=>{0!==b&&(a.innerHTML='<div class="app-up-data" style="text-align:center;margin-top: 50%;font-size: 16px; padding:20px;">\u66F4\u65B0\u5931\u8D25\uFF0C\u8BF7\u91CD\u65B0\u542F\u52A8</div>'),setTimeout(()=>{e()},2e3)})}catch(a){setTimeout(()=>{nw.Shell.openItem(h.join(i,q)),setTimeout(()=>{e()},2e3)},200)}return d()}}a()})},openInspectWin:function(){nw.Window.open('about:blank',{show:!1,width:799,height:799},(a)=>{a.maximize(),a.window.location='chrome://inspect/#devices',a.show()})},getVersionNum:c,quit:e,rmSync:f}}(require('lazyload'),require);