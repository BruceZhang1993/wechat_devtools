'use strict';!function(require,directRequire){const a=require('./a1dd553cc059d528bb0ef56afed53968.js'),b=require('./5dc59f418d85e854c1a12d402d29e2d7.js'),c=require('./0634ee2ebd3e560d9d4804ecc960160f.js'),d=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js');let e;module.exports={initMusic:function(d){if(!e){e=document.createElement('audio');let f=global.windowMap.get('MAIN'),g=f.window.document.body;g.appendChild(e),e.addEventListener('play',()=>{d({type:c.SIMULATOR_SET_BACKGROUND_AUDIO,data:{status:b.MUSIC_STATE_PLAY}}),a.triggerOnEvent({eventName:'onMusicPlay',data:{dataUrl:e.src}}),a.triggerOnEvent({eventName:'onBackgroundAudioStateChange',data:{state:'play'}})}),e.addEventListener('pause',()=>{e&&!e.ended&&(!e.error&&d({type:c.SIMULATOR_SET_BACKGROUND_AUDIO,data:{status:b.MUSIC_STATE_PAUSE}}),a.triggerOnEvent({eventName:'onMusicPause',data:{dataUrl:e.src}}),a.triggerOnEvent({eventName:'onBackgroundAudioStateChange',data:{state:'pause'}}))}),e.addEventListener('ended',()=>{d({type:c.SIMULATOR_SET_BACKGROUND_AUDIO,data:{status:b.MUSIC_STATE_END}}),a.triggerOnEvent({eventName:'onMusicEnd',data:{dataUrl:e.src}}),a.triggerOnEvent({eventName:'onBackgroundAudioStateChange',data:{state:'ended'}}),e.remove(),e=void 0}),e.addEventListener('waiting',()=>{a.triggerOnEvent({eventName:'onBackgroundAudioStateChange',data:{state:'waiting'}})}),e.addEventListener('error',(f)=>{d({type:c.SIMULATOR_SET_BACKGROUND_AUDIO,data:{status:b.MUSIC_STATE_ERROR}});let{target:g}=f,{error:h}=g,i=h.code;i=i===h.MEDIA_ERR_NETWORK?10002:i===h.MEDIA_ERR_DECODE?10003:10001;let j=h.code;a.triggerOnEvent({eventName:'onMusicError',data:{dataUrl:e.src,errMsg:'Error: '+e.error.code}}),a.triggerOnEvent({eventName:'onBackgroundAudioStateChange',data:{state:'error',errMsg:j,errCode:i}}),e.remove(),e=void 0})}},playMusic:function(a={}){a.src&&a.src!=e.src?(e.src=a.src,e.play(),e.currentTime=a.startTime||0):e.src&&e.play()},pauseMusic:function(a={}){e&&!e.paused&&e.pause()},resumeMusic:function(a={}){e&&e.paused&&e.play()},stopMusic:function(f={}){if(!e)return;let g=e.src;setTimeout(()=>{const e=d.dispatch.bind(d);e({type:c.SIMULATOR_SET_BACKGROUND_AUDIO,data:{status:b.MUSIC_STATE_END}}),a.triggerOnEvent({eventName:'onMusicEnd',data:{dataUrl:g}}),a.triggerOnEvent({eventName:'onBackgroundAudioStateChange',data:{state:'stop'}})}),e.remove(),e=void 0},seekMusic:function(a={}){e&&!e.paused&&(e.currentTime=1*a.currentTime)},getAudioBufferd:function(){let a=e?e.buffered:'';if(a){let c=e.currentTime;for(let d,b=0,e=a.length;b<e;b++)if(d=a,a.start(b)<=c&&a.end(b)>=c)return a.end(b)}return 0},getAudio:function(){return e},removeAudio:function(){e&&(e.remove(),e=void 0)}}}(require('lazyload'),require);