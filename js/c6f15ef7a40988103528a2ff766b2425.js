'use strict';!function(require,directRequire){function a(a){return 0===a.indexOf(m)}function b(b){if(a(b)){let a=b.replace(m,'');return f.join(n,a)}return b}function c(a,b){let c=o();return g.writeFileSync(f.join(n,`${c}${b}`),a),`${m}${c}${b}`}const d=require('crypto'),e=require('os'),f=require('path'),g=require('fs'),h=require('./92320c1386e6db6a6f2556736a9bc280.js'),i=require('./89ba85d67a88f7636d657c22b5d3e038.js'),j=require('./3bfffbe88b3d923921f851c0697974fe.js'),k='tmp',l='store',m='wxfile://',n=h.WeappFileCache;var o=function(){let a,b=i.getUserInfo(),c=j.getCurrent(),e=c.hash,h=b?b.openid:'unknow';do{var l=d.createHash('md5');l.update(`${e}${h}${Date.now()}${Math.random()}`),a=`${k}_${e}${h}${l.digest('hex')}`}while(g.existsSync(f.join(n,a)));return a};module.exports={isLocalId:a,getRealPath:b,copyFileDataToTemp:c,copyFileToTemp:function(a,b){if(g.existsSync(a)){let d=g.readFileSync(a);return c(d,b)}return!1},saveFileForever:function(a){try{let c=b(a);if(g.existsSync(c)){let d=a.replace(`${m}${k}`,`${m}${l}`);return g.renameSync(c,b(d)),d}}catch(a){}return!1},getSavedFileList:function(){let a=i.getUserInfo(),b=j.getCurrent(),c=b.hash,d=a?a.openid:'unknow',e=g.readdirSync(n).filter((a)=>{return!!~a.indexOf(`${l}_${c}${d}`)}),h=0,k=e.reduce((a,b)=>{let c=g.statSync(f.join(n,b));return h=c.size+h,a.push({filePath:`${m}${b}`,size:c.size,createTime:parseInt(c.ctime.getTime()/1e3)}),a},[]);return{fileList:k,totalSize:h}},getFileStat:function(a){let c,d=b(a);return g.existsSync(d)&&(c=g.statSync(d)),c},removeSavedFile:function(a){let c=b(a),d=!1;return g.existsSync(c)&&(g.unlinkSync(c),d=!0),d},saveBase64DataToFile:function(a,b){let c=new Buffer(a,'base64').toString('binary'),d=o();return g.writeFileSync(f.join(n,`${d}${b}`),c,'binary'),`${m}${d}${b}`},cleanProjectFile:function(a){let b=j.getCurrent(),c=g.readdirSync(n).filter((c)=>{return!!~c.indexOf(a?`_${b.hash}`:`${k}_${b.hash}`)});c.map((a)=>{g.unlinkSync(f.join(n,a))})},cleanTempFile:function(){try{g.readdirSync(n).map((a)=>{0<=a.indexOf(k)&&g.unlinkSync(f.join(n,item))})}catch(a){}},createNewLocalId:function(){return m+o()}}}(require('lazyload'),require);