'use strict';!function(require,directRequire){function a(a,b){a({type:f.SIMULATOR_SET_NAVIGATION_BAR,data:{showRecordWording:b}})}async function b(b,c){let{operationType:d,duration:e,format:f}=c.args;e=e||o,e>o&&(e=o);let p=Date.now(),q=0;return f=f||'aac',new Promise((d)=>{navigator.mediaDevices.getUserMedia(m).then((m)=>{j=[];try{k=new MediaRecorder(m,n)}catch(a){return void d({errMsg:`${c.api}:fail ${a}`})}k.onstart=()=>{p=Date.now(),l=setTimeout(()=>{k&&k.stop()},e)},k.onpause=()=>{clearTimeout(l),q=Date.now()-p},k.onresume=()=>{p=Date.now(),l=setTimeout(()=>{k&&k.stop()},e-q)},k.onstop=()=>{clearTimeout(l);let c=new Blob(j,{type:`audio/webm`}),d=Date.now()-p+q,e=new FileReader;e.addEventListener('loadend',()=>{let c=i.getCurrent(),j=h.copyFileDataToTemp(c,e.result,`.durationTime=${d}.${f}`);k=void 0,g.triggerOnEvent({eventName:'onRecorderStateChange',data:{tempFilePath:j,fileSize:e.result.length,duration:d,state:'stop'}}),a(b,!1)}),e.readAsDataURL(c)},k.ondataavailable=(a)=>{a.data&&0<a.data.size&&j.push(a.data)},k.onerror=(c)=>{g.triggerOnEvent({eventName:'onRecorderStateChange',data:{state:'error',errMsg:c.message}}),a(b,!1)},k.start(10),a(b,!0),d({errMsg:`${c.api}:ok`})}).catch((a)=>{d({errMsg:`${c.api}:fail ${a.name}`})})})}async function c(a,b){if(k)k.stop();else return{errMsg:`${b.api}:ok`};return{errMsg:`${b.api}:ok`}}async function d(b,c){if(k)k.pause();else return{errMsg:`${c.api}:fail`};return g.triggerOnEvent({eventName:'onRecorderStateChange',data:{state:'pause'}}),a(b,!1),{errMsg:`${c.api}:ok`}}async function e(b,c){if(k)k.resume();else return{errMsg:`${c.api}:fail`};return a(b,!0),{errMsg:`${c.api}:ok`}}const f=require('./0634ee2ebd3e560d9d4804ecc960160f.js'),g=require('./a1dd553cc059d528bb0ef56afed53968.js'),h=require('./f6cbcecf6ed9f533f6a506310d8f07b6.js'),i=require('./3bfffbe88b3d923921f851c0697974fe.js');var j,k,l;const m={audio:!0},n={mimeType:'audio/webm'},o=600000;module.exports={startRecord:async function(b,c){return new Promise((d)=>{navigator.mediaDevices.getUserMedia(m).then((e)=>{j=[];try{k=new MediaRecorder(e,n)}catch(a){return void d({errMsg:`${c.api}:fail ${a}`})}k.onstop=()=>{let e=new Blob(j,{type:'audio/webm'}),f=new FileReader;f.addEventListener('loadend',()=>{let a=i.getCurrent(),b=h.copyFileDataToTemp(a,f.result,'.silk');d({errMsg:`${c.api}:ok`,tempFilePath:b}),k=void 0}),f.readAsDataURL(e),a(b,!1)},k.ondataavailable=(a)=>{a.data&&0<a.data.size&&j.push(a.data)},clearTimeout(l),l=setTimeout(()=>{k&&k.stop()},60000),k.start(10),a(b,!0)}).catch(()=>{d({errMsg:`${c.api}:fail 未找到或者无权限调用录音设备`})})})},stopRecord:c,operateRecorder:async function(a,f){let{operationType:g,duration:h,format:i}=f.args;if('pause'===g)return await d(a,f);return'resume'===g?await e(a,f):'stop'===g?await c(a,f):'start'===g?await b(a,f):{errMsg:`${f.api}:fail illegal operationType`}}}}(require('lazyload'),require);