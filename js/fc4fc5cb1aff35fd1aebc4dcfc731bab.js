'use strict';!function(require,directRequire){function a(a,b){a({type:f.SIMULATOR_SET_NAVIGATION_BAR,data:{showRecordWording:b}})}async function b(b,c){let{operationType:d,duration:e,format:f}=c.args;f=f||'aac';let m={mimeType:`audio/webm`};return new Promise((d)=>{navigator.mediaDevices.getUserMedia(l).then((l)=>{i=[];try{j=new MediaRecorder(l,m)}catch(a){return void d({errMsg:`${c.api}:fail ${a}`})}j.onstart=()=>{durationTime=+new Date},j.onstop=()=>{let b=new Blob(i,{type:`audio/webm`});durationTime=+new Date-durationTime;let c=new FileReader;c.addEventListener('loadend',()=>{let b=h.copyFileDataToTemp(c.result,`.durationTime=${durationTime}.${f}`);j=void 0,g.triggerOnEvent({eventName:'onRecorderStateChange',data:{tempFilePath:b,fileSize:c.result.length,duration:durationTime,state:'stop'}}),a(!1)}),c.readAsDataURL(b)},j.ondataavailable=(a)=>{a.data&&0<a.data.size&&i.push(a.data)},j.onerror=(c)=>{g.triggerOnEvent({eventName:'onRecorderStateChange',data:{state:'error',errMsg:c.message}}),a(b,!1)},e=e||n,k=setTimeout(()=>{j&&j.stop()},e),j.start(10),a(b,!0),d({errMsg:`${c.api}:ok`})}).catch((a)=>{d({errMsg:`${c.api}:fail ${a.name}`})})})}async function c(a,b){if(clearTimeout(k),j)j.stop();else return{errMsg:`${b.api}:ok`};return{errMsg:`${b.api}:ok`}}async function d(b,c){if(j)j.pause();else return{errMsg:`${c.api}:fail`};return g.triggerOnEvent({eventName:'onRecorderStateChange',data:{state:'pause'}}),a(b,!1),{errMsg:`${c.api}:ok`}}async function e(b,c){if(j)j.resume();else return{errMsg:`${c.api}:fail`};return a(b,!0),{errMsg:`${c.api}:ok`}}const f=require('./0634ee2ebd3e560d9d4804ecc960160f.js'),g=require('./a1dd553cc059d528bb0ef56afed53968.js'),h=require('./c6f15ef7a40988103528a2ff766b2425.js');var i,j,k;const l={audio:!0},m={mimeType:'audio/webm'},n=600000;module.exports={startRecord:async function(b,c){return new Promise((d)=>{navigator.mediaDevices.getUserMedia(l).then((e)=>{i=[];try{j=new MediaRecorder(e,m)}catch(a){return void d({errMsg:`${c.api}:fail ${a}`})}j.onstop=()=>{let e=new Blob(i,{type:'audio/webm'}),f=new FileReader;f.addEventListener('loadend',()=>{let a=h.copyFileDataToTemp(f.result,'.silk');d({errMsg:`${c.api}:ok`,tempFilePath:a}),j=void 0}),f.readAsDataURL(e),a(b,!1)},j.ondataavailable=(a)=>{a.data&&0<a.data.size&&i.push(a.data)},clearTimeout(k),k=setTimeout(()=>{j&&j.stop()},60000),j.start(10),a(b,!0)}).catch(()=>{d({errMsg:`${c.api}:fail 未找到或者无权限调用录音设备`})})})},stopRecord:c,operateRecorder:async function(a,f){let{operationType:g,duration:h,format:i}=f.args;if('pause'===g)return await d(a,f);return'resume'===g?await e(a,f):'stop'===g?await c(a,f):'start'===g?await b(a,f):{errMsg:`${f.api}:fail illegal operationType`}}}}(require('lazyload'),require);