'use strict';!function(require,directRequire){function a(a){let b=g.createHash('md5');return b.update(a).digest('hex')}const b=require('fs'),c=require('path'),d=require('mkdir-p'),e=require('babel-core'),f=require('uglify-js'),g=require('crypto'),h=require('./162bf2ee28b76d3b3d95b685cede4146.js'),i=require('babel-code-frame'),j=require('./common/locales/index.js'),{bufToUTF8:k}=require('./efc820e1b92d6e4063535296d4a24213.js'),{FILE_NOT_UTF8:l,BABEL_TRANS_JS_ERR:m,UGLIFY_JS_ERR:n,BABILI_JS_ERR:o}=require('./949d8235c744ced2a80121e4dba34c28.js');var p={};module.exports=function(g,q={}){p[g.hash]||(p[g.hash]={});let r=p[g.hash];return new Promise(async(s,t)=>{let{es6:u,minified:v}=g.setting,{distPath:w}=q,x=await h(g),y=x.getAllJSFiles();for(let h=0,q=y.length;h<q;h++){let q=y[h],s=x.getFile(q,null),z=k(s);if(void 0===z){let a=new Error(j.config.FILE_NOT_UTF8.format(q));return a.code=l,t(a)}let A=Date.now(),B=a(z),C=`${q}_${u}_${v}`;if(r[C]&&r[C].md5===B)z=r[C].jsCode;else if(u||v){if(u){try{let a=e.transform(z,{presets:['es2015','stage-0'],babelrc:!1});z=a.code}catch(a){let b=`file: ${q}\n ${a.message}\n ${i(z,a.loc.line,0<a.loc.column?a.loc.column:1)}`,c=new Error(b);return c.code=m,t(c)}if(v){let a=f.minify(z,{toplevel:!0});if(a.error){let b=`file: ${q}\n ${a.error.message}\n ${i(z,a.error.line,0<a.error.col?a.error.col:1)}`,c=new Error(b);return c.code=n,t(c)}z=a.code}}else try{let a=e.transform(`(function(){\n ${z} \n})()`,{presets:['minify'],babelrc:!1});z=a.code}catch(a){let b=`file: ${q}\n ${a.message}\n ${i(z,a.loc.line,0<a.loc.column?a.loc.column:1)}`,c=new Error(b);return c.code=o,t(c)}p[g.hash][`${q}_${u}_${v}`]={md5:B,jsCode:z}}console.log(`${q} compilejs cost time: ${Date.now()-A}`);let D=c.join(w,q),E=c.dirname(D);d.sync(E),b.writeFileSync(D,z)}s()})}}(require('lazyload'),require);